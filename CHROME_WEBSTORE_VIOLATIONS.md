# Chrome 웹 스토어 위반 사항 및 해결 방안

## 🚨 현재 위반 사항들

### 1. **API 사용 위반 (Blue Nickel) - 해결됨**
- **문제**: 새 탭 페이지 재정의를 Override Pages API 없이 사용
- **해결**: `chrome_url_overrides` 제거 완료
- **상태**: ✅ 해결됨

### 2. **과도한 권한 (Purple Potassium) - 해결됨**
- **문제**: `tabs`, `webNavigation` 권한이 실제로 필요하지 않음
- **해결**: 불필요한 권한 제거 완료
- **현재 권한**: `storage`, `activeTab`, `scripting`, `contextMenus`
- **상태**: ✅ 해결됨

### 3. **단일 목적 원칙 위반 (Red Magnesium, Red Copper, Red Lithium, Red Argon)**
- **문제**: 확장 프로그램이 단일 목적을 벗어남
  - 새 탭 페이지 재정의
  - PDF 리다이렉트 기능
  - 시계 및 검색 기능
  - 다이렉트 기능들
- **상태**: ❌ 해결 필요

### 4. **기능 분리 필요**
- **문제**: 단어장 기능 외에 다른 기능들이 포함됨
- **상태**: ❌ 해결 필요

### 5. **일관성 문제**
- **문제**: 예문이 board view에서는 숨겨져 있음 (table view에서만 표시)
- **해결 필요**: 단어장 기능의 일관성 확보

## 🎯 해결 방안

### 1. **아이콘 클릭 동작 변경**
- **현재**: 팝업 메뉴 표시
- **변경**: 바로 홈페이지(단어장 페이지) 열기
- **설정**: 별도 설정 페이지로 분리

### 2. **제거할 기능들**
- ✅ 새 탭 페이지 재정의
- ❌ PDF 리다이렉트 (제거 예정)
- ❌ 시계 기능 (제거 예정)
- ❌ 검색 기능 (제거 예정)
- ❌ 다이렉트 기능들 (제거 예정)
- ❌ 새 탭 리다이렉트 (제거 예정)
- ❌ 모든 리다이렉션 기능 (제거 예정)

### 3. **유지할 핵심 기능들**
- ✅ 단어 저장 및 관리
- ✅ 정의 조회
- ✅ 퀴즈 기능
- ✅ 학습 진행 추적

### 4. **PDF 처리 방안**
- **현재**: PDF 리다이렉트
- **변경**: PDF 내에서 직접 텍스트 선택 가능하도록 개선
- **대안**: PDF.js 뷰어 링크 제공

### 5. **일관성 개선 방안**
- **현재**: 예문이 board view에서 숨겨짐
- **변경**: 모든 view에서 예문 표시
- **목표**: 단어장 기능의 일관성 확보

## 📋 작업 계획

### Phase 1: 기능 정리 (우선순위 높음)
1. [ ] 팝업에서 새 탭 재정의 설정 제거
2. [ ] **중요**: 모든 리다이렉션 기능 제거 (PDF, 새 탭 등)
3. [ ] 시계 및 검색 기능 제거
4. [ ] 다이렉트 기능들 제거
5. [ ] **중요**: `chrome.tabs` API 사용 코드 제거/수정
6. [ ] **중요**: `chrome.webNavigation` API 사용 코드 제거/수정
7. [ ] **중요**: `chrome.runtime.getURL('newtab.html')` 참조 제거
8. [ ] **중요**: `activeTab` 권한 제거 (사용되지 않음)
9. [ ] **중요**: 웹 접근 가능 리소스에서 불필요한 파일들 제거
10. [ ] **중요**: 예문 일관성 개선 (board view에서도 표시)

### Phase 2: UI 개선
1. [ ] 아이콘 클릭 시 바로 홈페이지 열기
2. [ ] 설정 페이지 분리
3. [ ] 단어장 중심 UI로 변경

### Phase 3: Chrome 웹 스토어 준수
1. [ ] 단일 목적 원칙 준수 확인
2. [ ] 권한 최소화 확인
3. [ ] 메타데이터 검토

## 🔍 잠재적 추가 문제점들

### 1. **외부 API 사용**
- **문제**: Dictionary API, Datamuse API 사용
- **검토 필요**: API 사용이 단어장 기능에 필수인지 확인

### 2. **콘텐츠 스크립트 범위**
- **현재**: `https://*/*` (모든 사이트)
- **검토 필요**: 실제로 필요한 사이트만으로 제한 가능한지

### 3. **웹 접근 가능 리소스**
- **현재**: 많은 리소스가 웹에서 접근 가능
- **검토 필요**: 실제로 필요한 리소스만 포함

### 4. **개인정보 보호**
- **검토 필요**: 사용자 데이터 수집 및 처리 방식
- **필요**: 개인정보 보호정책 확인

### 5. **코드에서 tabs API 사용 (중요!)**
- **문제**: `chrome.tabs` API가 여러 파일에서 사용됨
  - `newtab.js`: 8회 사용
  - `popup.js`: 3회 사용
  - `background.js`: 6회 사용
  - `today-voca.js`: 2회 사용
  - `today-voca-quiz.js`: 2회 사용
- **해결 필요**: `tabs` 권한을 제거했지만 코드에서 여전히 사용 중

### 6. **webNavigation API 사용**
- **문제**: `background.js`에서 `chrome.webNavigation` 사용
- **해결 필요**: `webNavigation` 권한을 제거했지만 코드에서 여전히 사용 중

### 7. **Manifest V3 원격 코드 실행 위반 가능성**
- **확인 완료**: `eval()` 사용 없음 - ✅ 안전
- **확인 완료**: 외부 스크립트 참조 없음 - ✅ 안전

### 8. **권한 사용 검토 결과**
- **storage**: ✅ 적절히 사용됨 (100+ 회 사용)
- **scripting**: ✅ 적절히 사용됨 (1회 사용)
- **contextMenus**: ✅ 적절히 사용됨 (2회 사용)
- **activeTab**: ❌ 권한은 있지만 실제로 사용되지 않음

### 9. **외부 API 사용 검토**
- **Dictionary API**: ✅ 단어장 기능에 필수
- **Datamuse API**: ✅ 단어 관계 및 stop words에 필수
- **Oxford Audio API**: ✅ 발음 기능에 필수

### 10. **chrome.runtime.getURL 사용 검토**
- **문제**: 여러 파일에서 `newtab.html` 참조
- **해결 필요**: 새 탭 재정의 제거 후 이 참조들도 수정 필요

### 11. **chrome.commands 사용 검토**
- **상태**: ✅ 적절히 사용됨 (1회 사용)
- **기능**: 단어 저장 단축키 - 핵심 기능

### 12. **웹 접근 가능 리소스 검토**
- **문제**: `newtab.html`, `today-voca.html` 등이 웹에서 접근 가능
- **해결 필요**: 새 탭 재정의 제거 후 이 리소스들도 제거 필요

### 13. **리다이렉션 기능 검토**
- **문제**: 여러 리다이렉션 기능이 존재
  - PDF 리다이렉트 (background.js)
  - 새 탭 리다이렉트 (background.js)
  - URL 리다이렉트 (newtab-check.js)
- **해결 필요**: 모든 리다이렉션 기능 제거

### 14. **일관성 문제 검토**
- **문제**: 예문이 board view에서 숨겨져 있음
- **위치**: `newtab.js` line 930 주석
- **해결 필요**: 단어장 기능의 일관성 확보

## 📝 다음 단계

1. **기능 정리 시작**
2. **UI 개선 작업**
3. **최종 검토 및 테스트**
4. **Chrome 웹 스토어 재제출**

---